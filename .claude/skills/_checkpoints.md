# Skills 确认检查点配置

本文件定义所有 Skills 执行时的确认点，确保用户审查后再继续。

## 全局规则

**ALWAYS** 在以下情况暂停并等待用户确认：
- 即将执行代码修改
- 即将执行 Git 操作
- 即将更新文档
- 完成重要阶段

**NEVER** 未经确认就执行：
- 文件删除
- Git push
- 部署操作
- 修改配置文件

## 检查点格式

每个检查点使用以下格式展示：

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
📍 检查点：{阶段名称}
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

{当前完成的内容摘要}

📋 即将执行：
{下一步要做的事情}

⚠️  影响范围：
{会影响哪些文件/功能}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
确认继续？
- 输入 y 或 继续 → 执行下一步
- 输入 n 或 停止 → 暂停，保留当前状态
- 输入 e 或 修改 → 修改后再继续
- 输入 ? 或 详情 → 查看详细信息
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

## 各 Skill 检查点

### plan-maker

| 检查点 | 时机 | 确认内容 |
|--------|------|----------|
| CP1 | 需求分析完成 | 确认理解是否正确 |
| CP2 | 技术方案确定 | 确认方案选择 |
| CP3 | 任务分解完成 | 确认任务列表 |
| CP4 | 计划保存前 | 确认最终计划 |

```
📍 检查点 CP1：需求分析

我理解的需求是：
- 功能：{功能描述}
- 目标：{目标}
- 范围：{包含/不包含}

这个理解正确吗？
```

### todo-runner

| 检查点 | 时机 | 确认内容 |
|--------|------|----------|
| CP1 | 开始任务前 | 确认要执行的任务 |
| CP2 | 代码修改前 | 确认修改方案 |
| CP3 | 任务完成后 | 确认是否继续下一个 |

```
📍 检查点 CP1：开始任务

即将执行任务：
#task-001: {任务描述}

预计修改：
- src/xxx.ts (+50 -10)
- src/yyy.ts (+20 -5)

开始执行？
```

### code-review

| 检查点 | 时机 | 确认内容 |
|--------|------|----------|
| CP1 | 审查完成 | 展示审查结果 |
| CP2 | 自动修复前 | 确认是否自动修复 |
| CP3 | 审查通过 | 确认是否继续提交 |

```
📍 检查点 CP1：代码审查完成

审查结果：
- 🔴 严重问题：2 个
- 🟡 建议修复：3 个
- 🟢 轻微问题：5 个

详见上方审查报告。

如何处理？
- y: 修复严重问题后继续
- n: 暂停审查
- skip: 跳过本次审查（不推荐）
```

### git-commit

| 检查点 | 时机 | 确认内容 |
|--------|------|----------|
| CP1 | 提交前 | 确认提交内容和信息 |
| CP2 | Push 前 | 确认是否推送 |

```
📍 检查点 CP1：确认提交

提交信息：
feat(auth): add user login endpoint

修改文件：
- src/auth/login.ts (+45 -0)
- src/models/user.ts (+12 -3)

确认提交？
```

### memory-sync

| 检查点 | 时机 | 确认内容 |
|--------|------|----------|
| CP1 | 同步前 | 展示将更新的内容 |

```
📍 检查点 CP1：记忆同步

即将更新：
- activeContext.md
  + 添加：完成用户登录功能
  + 更新：当前工作重点

- progress.md
  + 添加：2024-01-10 进度记录

确认同步？
```

### team-sync

| 检查点 | 时机 | 确认内容 |
|--------|------|----------|
| CP1 | 状态更新前 | 确认状态变更 |
| CP2 | 交接文档前 | 确认交接内容 |

```
📍 检查点 CP1：团队状态更新

即将更新 team/status.md：
- 标记 #task-001 为"已完成"
- 添加到"最近完成"列表
- 清除"当前活跃"中的记录

确认更新？
```

## 自定义检查点

可在 `.claude/settings.json` 中配置检查点行为：

```json
{
  "skills": {
    "checkpoints": {
      "enabled": true,
      "level": "normal",
      "skip": []
    }
  }
}
```

### level 选项

| 级别 | 说明 |
|------|------|
| `strict` | 每个小步骤都确认 |
| `normal` | 关键节点确认（默认） |
| `minimal` | 仅重要操作确认 |
| `auto` | 自动执行，仅在错误时暂停 |

### skip 选项

跳过特定检查点：
```json
{
  "skip": ["memory-sync.CP1", "team-sync.CP1"]
}
```
