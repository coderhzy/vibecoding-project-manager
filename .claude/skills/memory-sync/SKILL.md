# memory-sync

自动同步开发过程中的关键信息到持久化记忆系统。

## 触发条件

### 高优先级触发（立即同步）
- 完成重要功能实现
- 做出架构级技术决策
- 解决复杂问题
- 发现重大 bug 或安全问题

### 中优先级触发（批量同步）
- 完成一组相关修改
- 会话即将结束
- 用户切换任务上下文

### 低优先级触发（延迟同步）
- 小型代码修改
- 文档更新
- 配置调整

## 记忆层级

```
projectBrief.md (基础层 - 很少变更)
       ↓
activeContext.md (工作层 - 频繁更新)
       ↓
progress.md (历史层 - 追加记录)
       ↓
sessions/*.md (详细层 - 完整记录)
```

## 同步内容

### activeContext.md 更新内容

```markdown
## 活跃区域
- 当前正在工作的模块/文件
- 相关的上下文代码路径

## 最近变更
- 最近 5 次重要修改
- 每次修改的简要说明

## 待处理事项
- 从当前任务中发现的待办
- 技术债务记录

## 技术决策
- 最近做出的技术选择
- 决策理由（简要）
```

### progress.md 追加内容

```markdown
## {日期}

### 完成
- {完成的功能/任务}

### 决策
- {决策标题}: {简要说明}

### 问题
- {遇到的问题}: {解决方案}

### 学习
- {学到的经验}
```

## 同步策略

### 智能去重
- 避免重复记录相同信息
- 合并相似的变更记录
- 保持记录简洁

### 信息提炼
- 从详细对话中提取关键点
- 去除临时性、探索性内容
- 保留可复用的知识

### 上下文关联
- 关联相关的文件路径
- 链接到相关会话记录
- 标记相关的 TODO 项

## 执行流程

1. **收集信息**
   - 分析当前对话内容
   - 识别关键事件和决策
   - 提取可持久化的知识

2. **分类处理**
   - 判断信息类别（变更/决策/问题/学习）
   - 确定更新目标文件
   - 计算优先级

3. **增量更新**
   - 读取现有记忆文件
   - 智能合并新信息
   - 保持文件结构整洁

4. **验证完整性**
   - 确保链接有效
   - 检查格式一致性
   - 验证时间线连续

## 手动触发

```
/workflow:update-memory
/workflow:sync
```
