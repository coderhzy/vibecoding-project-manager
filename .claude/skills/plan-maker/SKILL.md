# plan-maker

智能创建和管理版本化开发计划。

## 触发条件

### 自动触发
- 用户描述新需求时
- 开始新的开发周期
- 需要任务分解时

### 手动触发
- `/plan`
- `/plan:new`
- `/plan:update`

## 计划层级

```
需求 → 史诗 → 故事 → 任务 → 子任务

Epic (史诗)
  └── Story (故事)
        └── Task (任务)
              └── Subtask (子任务)
```

## 计划文件结构

### 版本命名

```
.claude/plans/
├── plan-v001.md          # 初始计划
├── plan-v002.md          # 迭代更新
├── plan-v003.md          # 最新版本
└── archive/              # 归档的旧计划
    └── plan-v001.md
```

### 计划模板

```markdown
# 开发计划 v{version}

> 创建时间：{timestamp}
> 状态：草稿 | 进行中 | 已完成 | 已废弃

## 概述

### 目标
{一句话描述要达成什么}

### 背景
{为什么需要这个计划}

### 范围
- 包含：{在范围内的}
- 不包含：{明确排除的}

## 需求分析

### 功能需求
1. {需求1}
2. {需求2}

### 非功能需求
- 性能：{性能要求}
- 安全：{安全要求}
- 兼容：{兼容要求}

## 技术方案

### 架构决策
{技术选型和架构决策}

### 关键实现
{核心实现思路}

### 风险评估
| 风险 | 影响 | 概率 | 缓解措施 |
|------|------|------|----------|
| {风险1} | 高/中/低 | 高/中/低 | {措施} |

## 任务分解

### Epic 1：{史诗名称}

#### Story 1.1：{故事名称}
- [ ] Task 1.1.1：{任务描述}
- [ ] Task 1.1.2：{任务描述}

#### Story 1.2：{故事名称}
- [ ] Task 1.2.1：{任务描述}

### Epic 2：{史诗名称}
...

## 里程碑

| 里程碑 | 内容 | 验收标准 |
|--------|------|----------|
| M1 | {内容} | {标准} |
| M2 | {内容} | {标准} |

## 验收标准

- [ ] {标准1}
- [ ] {标准2}
- [ ] {标准3}

## 变更记录

| 版本 | 日期 | 变更内容 |
|------|------|----------|
| v001 | {date} | 初始版本 |
```

## 执行流程

### 1. 需求收集

与用户交互，明确：
- 要解决什么问题？
- 期望的结果是什么？
- 有什么限制条件？
- 优先级如何？

### 2. 方案设计

分析并提出：
- 技术方案选项
- 各方案优缺点
- 推荐方案及理由

### 3. 任务分解

原则：
- 每个任务可独立完成
- 任务粒度适中（2-4小时）
- 明确的完成标准
- 清晰的依赖关系

### 4. 计划审核

生成计划后：
```
📋 计划已生成：plan-v001.md

包含：
- 2 个 Epic
- 5 个 Story
- 12 个 Task

请审核并确认，或提出修改意见。
```

## 计划更新

当需要修改计划时：

1. 创建新版本（不修改旧版本）
2. 记录变更原因
3. 更新相关 TODO
4. 通知相关变更

```markdown
## 变更记录

| 版本 | 日期 | 变更内容 |
|------|------|----------|
| v001 | 2024-01-10 | 初始版本 |
| v002 | 2024-01-12 | 增加用户认证需求 |
| v003 | 2024-01-15 | 调整任务优先级 |
```

## 与 TODO 同步

计划确认后，自动同步到 TODO.md：

```
计划 plan-v001.md 已确认

同步到 TODO.md：
- 添加 12 个任务
- 设置优先级
- 标记依赖关系

开始执行？使用 /project:nextTODO
```

## 进度追踪

```markdown
## 进度

### Epic 1：用户系统 (60%)
- [x] Story 1.1：用户注册 ✅
- [~] Story 1.2：用户登录 (进行中)
- [ ] Story 1.3：权限管理

### Epic 2：内容管理 (0%)
- [ ] Story 2.1：文章发布
- [ ] Story 2.2：评论系统
```
